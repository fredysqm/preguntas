{% extends 'base.html' %}
{% block title %}Pregunta{% endblock %}
{% block content %}
    <div class="row">
        <!-- Pregunta -->
        <div class="pregunta col-xs-8 col-sm-8 col-md-8 col-lg-8">
        <h2><strong>{{ pregunta.titulo }}</strong></h2>
        <p>{{ pregunta.contenido }}</p>
        <ul>
            <li>Por {{ pregunta.autor }}</li>
            <li>{{ pregunta.n_respuestas }} Respuestas</li>
            <li>Votos {{ pregunta.n_votos }}</li>
            <li>{{ pregunta.n_vistas }} Vistas</li>
        </ul>
        <a href="/comentarios/crear?return_url={{ path }}&object_id={{ object_id }}">Añadir comentario a la pregunta</a>
        </div>
    </div>
    <div class="row">
        <hr/>
    </div>
    <div class="row">
        <!-- Respuesetas -->
        <h4>Respuestas</h4>
        <ul>
        {% if respuestas.count > 0 %}            
            {% for respuesta, comentarios in respuestas %}
            <li><strong>{{ respuesta.contenido }}</strong> -- Por <em>{{ respuesta.autor }}</em></li>
            <hr/>
            <h5>Comentarios de respuesta</h5>
            {% if comentarios.count > 0 %}
                {% for comentario in comentarios %}
                    <p>
                        {{ comentario.contenido }} -- Por <em>{{ comentario.autor }} </em>
                        {% if comentario.autor.id == user.id %}
                            <a href="{% url 'comentarios_editar_url' comentario.id %}">(Editar)</a> 
                        {% endif %}
                    </p>
                {% endfor %}
            {% else %}
            <strong><p>¡Esta respuesta aún no tiene comentarios!</p></strong>
            {% endif %}
            <small><a href="/comentarios/crear?return_url=/respuesta/{{ respuesta.id }}&object_id={{ respuesta.id }}">Comentar respuesta</a></small>
            {% endfor %}
        {% else %}
            <strong><p>¡Aún no hay respuestas!</p></strong>
        {% endif %}
        </ul>
    </div>
    <div class="row">
        <hr/>
    </div>
    <div class="row">
        <!-- Comentarios -->
        <h4>Comentarios</h4>
        <ul>        
        {% if comentarios.count > 0 %}
            {% for comentario in comentarios %}
            <li><strong>{{ comentario.contenido }}</strong> -- Por <em>{{ comentario.autor }} </em>
            {% if user.id == comentario.autor.id %} <a href="{% url 'comentarios_editar_url' comentario.id %}">(Editar)</a> {% endif %}
            </li>
            {% endfor %}
        {% else %}
            <strong><p>¡Aún no hay comentarios!</p></strong>
        {% endif %}
        </ul>
    </div>
{% endblock %}